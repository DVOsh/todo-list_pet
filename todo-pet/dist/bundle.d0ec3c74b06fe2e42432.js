/*! For license information please see bundle.d0ec3c74b06fe2e42432.js.LICENSE.txt */
(()=>{"use strict";localStorage.clear();const e=new class{constructor(){this.storageObj={},localStorage["task-list"]||(localStorage.setItem("task-list",JSON.stringify(this.storageObj)),console.log("Tasks local storage created"))}addItem(e){const t=this.getCurrentStorage();t[Date.now()]={value:e,isChecked:!1},localStorage.setItem("task-list",JSON.stringify(t,null,2))}editItem(e,t){const s=this.getCurrentStorage();for(let i of Object.values(s))i.value==e&&(i.value=t);localStorage.setItem("task-list",JSON.stringify(s,null,2))}onItemCheck(e,t){const s=this.getCurrentStorage();for(let i of Object.values(s))i.value==e&&(i.isChecked=t);localStorage.setItem("task-list",JSON.stringify(s,null,2))}removeItem(e){const t=this.getCurrentStorage();for(let s of Object.values(t))if(s.value==e){const e=Object.values(t).indexOf(s);delete t[Object.keys(t)[e]]}delete t[e],localStorage.setItem("task-list",JSON.stringify(t,null,2))}getCurrentStorage(){return JSON.parse(localStorage.getItem("task-list"))}},t=document.querySelector(".main__input"),s=document.querySelector(".main-field__container"),i=document.querySelector(".tabs-field__items"),n=document.querySelector(".tabs-field__item.active"),l=document.querySelector(".tabs-field__item.completed"),c=document.querySelector(".tabs-field__close-tab");function a(t){const s=t.target.closest(".task-template__container").querySelector(".task-template__text");this.checked?s.classList.add("completed"):s.classList.remove("completed"),e.onItemCheck(s.innerText,this.checked),d()}function o(e,t=!1){t?(e.style.marginTop="-135px",e.style.opacity="0.5"):(e.style.marginTop="-35px",e.style.opacity="1")}function r(){const t=e.getCurrentStorage();let s={checked:0,unchecked:0};for(let e in t)t[e].isChecked?++s.checked:++s.unchecked;return s}function d(){n.classList.contains("visible")?0==r().unchecked&&n.classList.remove("visible"):r().unchecked>0&&n.classList.add("visible"),l.classList.contains("visible")?0==r().checked&&(c.classList.remove("visible"),l.classList.remove("visible")):r().checked>0&&(l.classList.add("visible"),c.classList.add("visible"))}t.addEventListener("keyup",(function(i){if("Enter"!=i.code||!this.value||this.value.match(/^\s*$/))return;const n=e.getCurrentStorage();let l=0;for(let e of Object.values(n)){if(e.value==this.value)return s.children[l+1].classList.add("duplicated"),void setTimeout((()=>{s.children[l+1].classList.remove("duplicated")}),500);l++}const c=function(e){const t=document.createElement("div");return t.classList.add("main-field__task","task-template"),t.innerHTML='\n<div class="task-template__container">\n    <label class="task-template__check">\n        <input type="checkbox">\n        <span></span>\n    </label>\n    <div class="task-template__text"></div>\n    <div class="task-template__remove"></div>\n</div>\n',t.querySelector(".task-template__text").innerText=e,t.style.position="relative",t.style.zIndex=window.getComputedStyle(s.lastElementChild).zIndex-1,setTimeout((()=>{t.style.marginTop="-35px"})),t}(this.value);s.append(c),c.querySelector('input[type="checkbox"]').addEventListener("change",a),e.addItem(this.value),t.value="",d()})),s.addEventListener("click",(function(t){const s=t.target.closest(".task-template__remove");if(!s)return;const i=s.closest(".main-field__task");o(i,!0),setTimeout((()=>{i.remove()}),1e3*parseFloat(getComputedStyle(i).transitionDuration)),e.removeItem(i.querySelector(".task-template__text").innerText),d()})),s.addEventListener("dblclick",(function(t){const s=t.target.closest(".task-template__text");if(!s)return;const i=s.innerText,n=document.createElement("input");n.classList.add("edit-input"),n.value=i,n.selectionStart=n.value.length,s.parentElement.append(n),n.focus(),n.addEventListener("keyup",(function(t){"Escape"==t.code&&this.blur(),"Enter"==t.code&&(this.value.match(/^\s*$/)&&(this.closest(".task-template").remove(),e.removeItem(i)),s.innerText=this.value,e.editItem(i,this.value),this.blur())})),n.onblur=function(e){this.remove()}})),i.addEventListener("click",(function(t){const n=t.target.closest(".tabs-field__item");if(!n)return;const l=document.querySelector(".tabs-field__wrapper"),c=n.getBoundingClientRect().x-i.getBoundingClientRect().x;l.style.left=c-24+"px";const a=e.getCurrentStorage();if(n.classList.contains("active")){let e=0;for(let t in a)a[t].isChecked?o(s.children[e+1],!0):o(s.children[e+1]),e++}else if(n.classList.contains("completed")){let e=0;for(let t in a)a[t].isChecked?o(s.children[e+1]):o(s.children[e+1],!0),e++}else if(n.classList.contains("all"))for(let e of s.children)"-135px"==getComputedStyle(e).marginTop&&o(e)})),c.addEventListener("click",(function(t){const i=e.getCurrentStorage();let n=0;for(let t in i){if(i[t].isChecked){let i=s.children[n+1];o(i,!0),i.addEventListener("transitionend",(function(){this.remove()})),e.removeItem(t),d()}n++}})),c.addEventListener("mouseover",(function(e){if(!e.target.closest(".close-field__icon"))return;const t=document.createElement("div");t.classList.add("close-field__tooltip"),t.innerText="Clear completed",this.append(t),this.addEventListener("mouseout",(()=>{t.remove()}))}))})();